<template>
    <c-msg-generator-subject oncontextchanged={handleContextChanged}></c-msg-generator-subject>
    <c-msg-generator-fields record-id={recordId} onfieldschanged={handleFieldsChanged} ></c-msg-generator-fields>
    <c-msg-generator-options onoptionschanged={handleOptionsChanged} ></c-msg-generator-options>
    <lightning-card  title="Preview" icon-name="utility:sparkles">
     <div class="slds-m-top_small slds-m-bottom_medium">
      <lightning-button variant="brand" label="Generate" title="Generate" onclick={handleGenerate}   class="slds-m-left_large" disabled={generateActive}></lightning-button> 
      <div class="slds-m-around_large">
        <p if:false={isLoaded}></p>

        <div if:true={isLoaded} class="slds-is-relative">
            <lightning-spinner alternative-text="Loading" size="x-small"></lightning-spinner>
        </div>
      </div>
    </div>
      <div class=" slds-p-around_medium textarea-container">
           <lightning-textarea
               placeholder="Your AI generated will be shown here"
               value={displayedText}
               name="monTextarea"
               oninput={handleInputChange}
               onchange={handelChange}></lightning-textarea>
           <div class="slds-p-around_medium custom-button">
                  <lightning-button-icon icon-name="utility:close"  variant="container" alternative-text="stop" onclick={stopTyping} disabled={stopActive} ></lightning-button-icon>
                  <lightning-badge label={numversion} ></lightning-badge>
                   <lightning-button-icon icon-name="utility:back"   variant="container" alternative-text="back" class="slds-m-left_xx-small" onclick={handleBack} disabled={backActive} ></lightning-button-icon>
                   <lightning-button-icon icon-name="utility:forward"    variant="container" alternative-text="forward"   class="slds-m-left_xx-small" onclick={handleForword} disabled={forwardActive} ></lightning-button-icon>
                   <lightning-button-icon icon-name="utility:copy"    variant="container" alternative-text="copy"   class="slds-m-left_xx-small" title="copy" onclick={handleCopy} disabled={copyActive} ></lightning-button-icon>
                   <lightning-button-icon icon-name="utility:skip_back"      variant="container" alternative-text="skip_back"     class="slds-m-left_xx-small" title="regenerate" onclick={handleRegenerate} disabled={regenerateActive} ></lightning-button-icon>
           </div>
       </div>
       <lightning-button label="Send" onclick={handleEmail} variant="brand" class="send-btn"></lightning-button>

     </lightning-card>
   </template>